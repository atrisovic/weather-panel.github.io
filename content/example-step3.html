
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hands-On Exercise, Step 3: Aggregating the data</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Producing results" href="producing-results.html" />
    <link rel="prev" title="Weighting schemes" href="weighting-schemes.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/climate_estimate_logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="getting-started.html">
   Introduction to the Tutorial
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Weather and Climate Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="weather-and-climate-data.html">
   Using Weather and Climate Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working-with-data-product.html">
   How to Start Working with a Data Product
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="example-step1.html">
   Hands-On Exercise, Step 1: Preparing the Weather Data
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Developing a reduced-form specification
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="reduced-form-specification.html">
   Developing a reduced-form specification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functional-forms.html">
   Functional forms: pros, cons, and methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="example-step2.html">
   Hands-On Exercise, Step 2: Understanding the outcomes
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Geographical unit data
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="geographical-unit-data.html">
   Generating geographical unit data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working-with-shapefiles.html">
   Constructing weather averages within spatial units
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="weighting-schemes.html">
   Weighting schemes
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Hands-On Exercise, Step 3: Aggregating the data
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Bringing it all together
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="producing-results.html">
   Producing results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="example-step4.html">
   Hands-On Exercise, Step 4: Producing results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="suggestions.html">
   Suggestions for work organization
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Contributors
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="contributors.html">
   Contributors
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/example-step3.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/atrisovic/weather-panel.github.io/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/atrisovic/weather-panel.github.io//issues/new?title=Issue%20on%20page%20%2Fcontent/example-step3.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/atrisovic/weather-panel.github.io/edit/master/tutorial-content/content/example-step3.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aggregating-the-weather-data">
   Aggregating the weather data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#setting-up-the-environment">
   Setting up the environment
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#transforming-the-data">
   Transforming the data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-map-of-pixels-onto-polygons">
   Create map of pixels onto polygons
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#aggregate-values-onto-polygons">
   Aggregate values onto polygons
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#export-this-as-a-csv-file-to-be-used-elsewhere">
   Export this as a
   <code class="docutils literal notranslate">
    <span class="pre">
     .csv
    </span>
   </code>
   file to be used elsewhere
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="hands-on-exercise-step-3-aggregating-the-data">
<h1>Hands-On Exercise, Step 3: Aggregating the data<a class="headerlink" href="#hands-on-exercise-step-3-aggregating-the-data" title="Permalink to this headline">¶</a></h1>
<div class="section" id="aggregating-the-weather-data">
<h2>Aggregating the weather data<a class="headerlink" href="#aggregating-the-weather-data" title="Permalink to this headline">¶</a></h2>
<p>One of the tutorial authors has produced a new tool for aggregating
gridded data according to a shapefile: <code class="docutils literal notranslate"><span class="pre">xagg</span></code>. Since it handles
partial grid-cell overlapping and arbitrary weighting grid, we
recommend that it be used irrespective of the language being used
elsewhere. Install it according to <a class="reference external" href="https://github.com/ks905383/xagg">the instructions from GitHub</a>.</p>
<p>You will need to download a shapefile for the US counties. We use one
from the ESRI community website:
<a class="reference external" href="https://community.esri.com/ccqpr47374/attachments/ccqpr47374/enterprise-portal/4124/1/UScounties.zip">https://community.esri.com/ccqpr47374/attachments/ccqpr47374/enterprise-portal/4124/1/UScounties.zip</a></p>
<p>Save its contents to a folder <code class="docutils literal notranslate"><span class="pre">geo_data</span></code> in the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory. The
following code should be run from the <code class="docutils literal notranslate"><span class="pre">data</span></code> directory.</p>
</div>
<div class="section" id="setting-up-the-environment">
<h2>Setting up the environment<a class="headerlink" href="#setting-up-the-environment" title="Permalink to this headline">¶</a></h2>
<p>The approach uses <code class="docutils literal notranslate"><span class="pre">xarray</span></code> for gridded data, <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> to work with shapefiles, and <code class="docutils literal notranslate"><span class="pre">xagg</span></code> to aggregate gridded data onto shapefiles.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="005cfc2d-d970-4737-b08c-ed733af9dbb8" name="62ae0908-0abb-4f40-9d10-3957ff99d4ea" type="radio">
</input><label class="tabbed-label" for="005cfc2d-d970-4737-b08c-ed733af9dbb8">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">xagg</span> <span class="k">as</span> <span class="nn">xa</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<p>First, load the data from the previous steps:</p>
<div class="tabbed-set docutils">
<input checked="checked" id="411a8040-ef25-494d-a386-6bd170030edf" name="160c3d3b-7985-4900-ae9e-aa2212cff2e5" type="radio">
</input><label class="tabbed-label" for="411a8040-ef25-494d-a386-6bd170030edf">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load temperature data using xarray</span>
<span class="n">ds_tas</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span>
    <span class="s1">&#39;climate_data/tas_day_BEST_historical_station_19800101-19891231.nc&#39;</span><span class="p">)</span>

<span class="c1"># Load population data using xarray </span>
<span class="n">ds_pop</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="s1">&#39;pcount/usap90ag.nc&#39;</span><span class="p">)</span>

<span class="c1"># Load county shapefiles using geopandas</span>
<span class="n">gdf_counties</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">read_file</span><span class="p">(</span><span class="s1">&#39;geo_data/UScounties.shp&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="transforming-the-data">
<h2>Transforming the data<a class="headerlink" href="#transforming-the-data" title="Permalink to this headline">¶</a></h2>
<p>Next, we need to construct any nonlinear transformations of the data.</p>
<p>For our econometric model, we want temperature in both linear and quadratic form, centered around <span class="math notranslate nohighlight">\(20^\circ\)</span> C: <span class="math notranslate nohighlight">\(T-20^\circ C\)</span> and <span class="math notranslate nohighlight">\(T^2 - (20^\circ C)^2\)</span>.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="df4f5435-f223-4c0a-b38a-811a3f456d6c" name="2516fda9-0ea5-4768-b022-cd6f6f453cd1" type="radio">
</input><label class="tabbed-label" for="df4f5435-f223-4c0a-b38a-811a3f456d6c">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds_tas</span><span class="p">[</span><span class="s1">&#39;tas_adj&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_tas</span><span class="o">.</span><span class="n">tas</span><span class="o">-</span><span class="mi">20</span>
<span class="n">ds_tas</span><span class="p">[</span><span class="s1">&#39;tas_sq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ds_tas</span><span class="o">.</span><span class="n">tas</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">20</span><span class="o">**</span><span class="mi">2</span>

<span class="c1"># xagg aggregates every gridded variable in ds_tas - however, we don&#39;t need</span>
<span class="c1"># every variable currently in tas. Let&#39;ss drop &quot;tas&quot; (the un-adjusted temperature)</span>
<span class="c1"># and &quot;land_mask&quot; which is included, but not necessary for our further analysis.</span>
<span class="n">ds_tas</span> <span class="o">=</span> <span class="n">ds_tas</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;tas&#39;</span><span class="p">)</span>
<span class="n">ds_tas</span> <span class="o">=</span> <span class="n">ds_tas</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s1">&#39;land_mask&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="create-map-of-pixels-onto-polygons">
<h2>Create map of pixels onto polygons<a class="headerlink" href="#create-map-of-pixels-onto-polygons" title="Permalink to this headline">¶</a></h2>
<p>We need to create a weight map of pixels to polygons. For each
polygon, we need to know which pixels overlap it and by how much.</p>
<p><code class="docutils literal notranslate"><span class="pre">xagg</span></code> does this by creating polygons for each pixel in the gridded
dataset, taking the intersect between each county polygon and all
pixel polygons, and calculating the average area of overlap between
the pixels that touch the polygon and the polygon.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="6bac3357-f596-4df4-bbae-ee0365b00d9c" name="e135a34b-78ee-4780-82dd-f14a13a16a4f" type="radio">
</input><label class="tabbed-label" for="6bac3357-f596-4df4-bbae-ee0365b00d9c">
Python</label><div class="tabbed-content docutils">
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">weightmap</span> <span class="o">=</span>
<span class="n">xa</span><span class="o">.</span><span class="n">pixel_overlaps</span><span class="p">(</span><span class="n">ds_tas</span><span class="p">,</span><span class="n">gdf_counties</span><span class="p">,</span><span class="n">weights</span><span class="o">=</span><span class="n">ds_pop</span><span class="o">.</span><span class="n">Population</span><span class="p">,</span><span class="n">subset_bbox</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="aggregate-values-onto-polygons">
<h2>Aggregate values onto polygons<a class="headerlink" href="#aggregate-values-onto-polygons" title="Permalink to this headline">¶</a></h2>
<p>Using the weight map calculated above, <code class="docutils literal notranslate"><span class="pre">xagg</span></code> now aggregates all the gridded variables in <code class="docutils literal notranslate"><span class="pre">ds_tas</span></code> (the <code class="docutils literal notranslate"><span class="pre">tas_adj</span></code> and <code class="docutils literal notranslate"><span class="pre">tas_sq</span></code> we calculated above) onto the county polygons. For each county, the weighted average of the temperatures of the pixels that cover the county is calculated. Since we included population as a desired weight above, the weight for each pixel is a combination of how much of the pixel overlaps with the county and its population density. In other words, a pixel that covers more of a county and has a higher population density will be weighted more in that county’s temperature average than a pixel that covers less of a county and is more sparsely populated.</p>
<p>The output of this function now gives, for each county, a 10-year time series of linear and quadratic temperature, properly area- and population-weighted.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="616b5b9b-6269-4300-a9e4-8c1270665147" name="72443942-9c7e-4549-b54f-b6de553d5aa5" type="radio">
</input><label class="tabbed-label" for="616b5b9b-6269-4300-a9e4-8c1270665147">
Python</label><div class="tabbed-content docutils">
<p><code class="docutils literal notranslate"><span class="pre">aggregated</span></code> is an object specific to the <code class="docutils literal notranslate"><span class="pre">xagg</span></code> package. We need to modify it to be usable, for example using <code class="docutils literal notranslate"><span class="pre">aggregated.to_dataset()</span></code> or <code class="docutils literal notranslate"><span class="pre">aggregated.to_csv</span></code>. See the <code class="docutils literal notranslate"><span class="pre">xagg</span></code> docs for more info.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">aggregated</span> <span class="o">=</span> <span class="n">xa</span><span class="o">.</span><span class="n">aggregate</span><span class="p">(</span><span class="n">ds_tas</span><span class="p">,</span> <span class="n">weightmap</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="export-this-as-a-csv-file-to-be-used-elsewhere">
<h2>Export this as a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> file to be used elsewhere<a class="headerlink" href="#export-this-as-a-csv-file-to-be-used-elsewhere" title="Permalink to this headline">¶</a></h2>
<p>Finally, we need to export this data to be used elsewhere. For this tutorial, we want to allow a variety of tools, so we’ll
export the aggregated data into a <code class="docutils literal notranslate"><span class="pre">.csv</span></code> (comma-separated value) file,
which can easily be read by R, STATA, and most other programming
tools. The data will be reshaped ‘wide’ by <code class="docutils literal notranslate"><span class="pre">xagg</span></code> - so every row is a
county, and every column is a timestep of the variables.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="d10e4739-18c5-4f08-a5f1-2ff4912ac9e8" name="cf8e53ef-e912-4f38-80c1-7bd9f89045eb" type="radio">
</input><label class="tabbed-label" for="d10e4739-18c5-4f08-a5f1-2ff4912ac9e8">
Python</label><div class="tabbed-content docutils">
<p>Use <code class="docutils literal notranslate"><span class="pre">aggregated.to_dataset()</span></code> or <code class="docutils literal notranslate"><span class="pre">aggregated.to_dataframe()</span></code>, depending on whether you’d like to continue using it in <code class="docutils literal notranslate"><span class="pre">xarray</span></code> or <code class="docutils literal notranslate"><span class="pre">pandas</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">aggregated</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;climate_data/agg_vars.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="weighting-schemes.html" title="previous page">Weighting schemes</a>
    <a class='right-next' id="next-link" href="producing-results.html" title="next page">Producing results</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>