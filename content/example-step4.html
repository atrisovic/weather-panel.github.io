
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Hands-On Exercise, Step 4: Producing results</title>
    
  <link rel="stylesheet" href="../_static/css/index.73d71520a4ca3b99cfee5594769eaaae.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.3da636dd464baa7582d2.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.png"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Suggestions for work organization" href="suggestions.html" />
    <link rel="prev" title="Producing results" href="producing-results.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/climate_estimate_logo.png" class="logo" alt="logo">
  
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="getting-started.html">
   Introduction to the Tutorial
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Weather and Climate Data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="weather-and-climate-data.html">
   Using Weather and Climate Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working-with-data-product.html">
   How to Start Working with a Data Product
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="example-step1.html">
   Hands-On Exercise, Step 1: Preparing the Weather Data
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Developing a reduced-form specification
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="reduced-form-specification.html">
   Developing a reduced-form specification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="functional-forms.html">
   Functional forms: pros, cons, and methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="example-step2.html">
   Hands-On Exercise, Step 2: Understanding the outcomes
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Geographical unit data
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="geographical-unit-data.html">
   Generating geographical unit data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="working-with-shapefiles.html">
   Constructing weather averages within spatial units
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="weighting-schemes.html">
   Weighting schemes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="example-step3.html">
   Hands-On Exercise, Step 3: Aggregating the data
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Bringing it all together
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="producing-results.html">
   Producing results
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Hands-On Exercise, Step 4: Producing results
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="suggestions.html">
   Suggestions for work organization
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Contributors
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="contributors.html">
   Contributors
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/content/example-step4.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/atrisovic/weather-panel.github.io/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/atrisovic/weather-panel.github.io//issues/new?title=Issue%20on%20page%20%2Fcontent/example-step4.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        <a class="edit-button" href="https://github.com/atrisovic/weather-panel.github.io/edit/master/tutorial-content/content/example-step4.md"><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Edit this page"><i class="fas fa-pencil-alt"></i>suggest edit</button></a>
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#constructing-annual-polynomials-summed-over-days">
   Constructing annual polynomials summed over days
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-weather-and-outcome-data">
   Merging weather and outcome data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#running-the-regression">
   Running the regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-the-resulting-dose-response-function">
   Plotting the resulting dose-response function
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="hands-on-exercise-step-4-producing-results">
<h1>Hands-On Exercise, Step 4: Producing results<a class="headerlink" href="#hands-on-exercise-step-4-producing-results" title="Permalink to this headline">¶</a></h1>
<div class="section" id="constructing-annual-polynomials-summed-over-days">
<h2>Constructing annual polynomials summed over days<a class="headerlink" href="#constructing-annual-polynomials-summed-over-days" title="Permalink to this headline">¶</a></h2>
<p>We have county aggregated data from the previous step, but we also
need to sum it to the annual level to match the mortality data. Again,
this code should be run from a sister directory to the <code class="docutils literal notranslate"><span class="pre">data</span></code>
directory.</p>
<p>Let’s first turn the data from wide form into long form and label the
years.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="ab4a0e85-cee4-43aa-8a03-21306313cd3e" name="e0728d2f-e4bc-4aa3-b972-559628830aad" type="radio">
</input><label class="tabbed-label" for="ab4a0e85-cee4-43aa-8a03-21306313cd3e">
R</label><div class="tabbed-content docutils">
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">reshape2</span><span class="p">)</span>

<span class="n">clim</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;../data/climate_data/agg_vars.csv&quot;</span><span class="p">)</span>

<span class="n">clim2</span> <span class="o">&lt;-</span> <span class="nf">melt</span><span class="p">(</span><span class="n">clim</span><span class="p">[,</span> <span class="nf">c</span><span class="p">(</span><span class="m">-1</span><span class="o">:</span><span class="m">-5</span><span class="p">)],</span> <span class="n">id.vars</span><span class="o">=</span><span class="s">&#39;FIPS&#39;</span><span class="p">)</span>
<span class="n">clim2</span><span class="o">$</span><span class="n">date</span> <span class="o">&lt;-</span> <span class="nf">as.Date</span><span class="p">(</span><span class="s">&quot;1980-01-01&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="nf">gsub</span><span class="p">(</span><span class="s">&quot;tas_adj|tas_sq&quot;</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">clim2</span><span class="o">$</span><span class="n">variable</span><span class="p">))</span>
<span class="n">clim2</span><span class="o">$</span><span class="n">year</span> <span class="o">&lt;-</span> <span class="nf">as.numeric</span><span class="p">(</span><span class="nf">substring</span><span class="p">(</span><span class="n">clim2</span><span class="o">$</span><span class="n">date</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">4</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can sum over years. To do this, we will need to base this on
the first several characters of the column names (not variable row
values).</p>
<div class="tabbed-set docutils">
<input checked="checked" id="6233a1ff-c35b-433f-8a82-f9dc670dae09" name="69dd4632-4bc3-405f-b3cb-a6c5b28293b4" type="radio">
</input><label class="tabbed-label" for="6233a1ff-c35b-433f-8a82-f9dc670dae09">
R</label><div class="tabbed-content docutils">
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">dplyr</span><span class="p">)</span>

<span class="n">clim3</span> <span class="o">&lt;-</span> <span class="n">clim2</span> <span class="o">%&gt;%</span> <span class="nf">group_by</span><span class="p">(</span><span class="n">FIPS</span><span class="p">,</span> <span class="n">year</span><span class="p">)</span> <span class="o">%&gt;%</span> <span class="nf">summarize</span><span class="p">(</span><span class="n">tas_adj</span><span class="o">=</span><span class="nf">sum</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="nf">substring</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">7</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;tas_adj&#39;</span><span class="p">]),</span> <span class="n">tas_sq</span><span class="o">=</span><span class="nf">sum</span><span class="p">(</span><span class="n">value</span><span class="p">[</span><span class="nf">substring</span><span class="p">(</span><span class="n">variable</span><span class="p">,</span> <span class="m">1</span><span class="p">,</span> <span class="m">6</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;tas_sq&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="merging-weather-and-outcome-data">
<h2>Merging weather and outcome data<a class="headerlink" href="#merging-weather-and-outcome-data" title="Permalink to this headline">¶</a></h2>
<p>And now we can merge in the mortality data! This is by county (FIPS
code) and year. We also construct the death rate, as deaths per
100,000 people in the population.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="1e40e204-98b7-41f8-8fa1-5ce7f407fbba" name="85f1a7ad-97c7-48ab-843a-8b4c832bb601" type="radio">
</input><label class="tabbed-label" for="1e40e204-98b7-41f8-8fa1-5ce7f407fbba">
R</label><div class="tabbed-content docutils">
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">&lt;-</span> <span class="nf">read.csv</span><span class="p">(</span><span class="s">&quot;../data/cmf/merged.csv&quot;</span><span class="p">)</span>

<span class="n">df2</span> <span class="o">&lt;-</span> <span class="n">df</span> <span class="o">%&gt;%</span> <span class="nf">left_join</span><span class="p">(</span><span class="n">clim3</span><span class="p">,</span> <span class="n">by</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="s">&#39;fips&#39;</span><span class="o">=</span><span class="s">&#39;FIPS&#39;</span><span class="p">,</span> <span class="s">&#39;year&#39;</span><span class="p">))</span>

<span class="n">df2</span><span class="o">$</span><span class="n">deathrate</span> <span class="o">&lt;-</span> <span class="m">100000</span> <span class="o">*</span> <span class="n">df2</span><span class="o">$</span><span class="n">deaths</span> <span class="o">/</span> <span class="n">df2</span><span class="o">$</span><span class="n">pop</span>
<span class="n">df2</span><span class="o">$</span><span class="n">deathrate</span><span class="p">[</span><span class="n">df2</span><span class="o">$</span><span class="n">deathrate</span> <span class="o">==</span> <span class="kc">Inf</span><span class="p">]</span> <span class="o">&lt;-</span> <span class="kc">NA</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="running-the-regression">
<h2>Running the regression<a class="headerlink" href="#running-the-regression" title="Permalink to this headline">¶</a></h2>
<p>Let’s run our central regression, relating death rate to
temperature. Note that since we do not control for precipitation,
temperature in this case includes correlated effects of rainfall. As a
result, it is not ideal for future projections.</p>
<p>For fixed effects, we use county fixed effects and state trends. More
saturated fixed effects should be explored.</p>
<div class="tabbed-set docutils">
<input checked="checked" id="978acc14-4e23-40b8-93ab-af1c258d5177" name="41f51261-c384-441c-ae38-3a355a0095bb" type="radio">
</input><label class="tabbed-label" for="978acc14-4e23-40b8-93ab-af1c258d5177">
R</label><div class="tabbed-content docutils">
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">lfe</span><span class="p">)</span>

<span class="n">df2</span><span class="o">$</span><span class="n">state</span> <span class="o">&lt;-</span> <span class="nf">as.character</span><span class="p">(</span><span class="nf">floor</span><span class="p">(</span><span class="n">df2</span><span class="o">$</span><span class="n">fips</span> <span class="o">/</span> <span class="m">1000</span><span class="p">))</span>

<span class="n">mod</span> <span class="o">&lt;-</span> <span class="nf">felm</span><span class="p">(</span><span class="n">deathrate</span> <span class="o">~</span> <span class="n">tas_adj</span> <span class="o">+</span> <span class="n">tas_sq</span> <span class="o">|</span> <span class="o">+</span> <span class="nf">factor</span><span class="p">(</span><span class="n">state</span><span class="p">)</span> <span class="o">:</span> <span class="n">year</span> <span class="o">+</span>  <span class="nf">factor</span><span class="p">(</span><span class="n">fips</span><span class="p">)</span> <span class="o">|</span> <span class="m">0</span> <span class="o">|</span> <span class="n">fips</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="plotting-the-resulting-dose-response-function">
<h2>Plotting the resulting dose-response function<a class="headerlink" href="#plotting-the-resulting-dose-response-function" title="Permalink to this headline">¶</a></h2>
<p>To plot the result, we construct evenly sampled temperature from <span class="math notranslate nohighlight">\(-20^\circ\)</span> C
(<span class="math notranslate nohighlight">\(-4^\circ\)</span> F) to <span class="math notranslate nohighlight">\(40^\circ\)</span> C (<span class="math notranslate nohighlight">\(104^\circ\)</span> F). Then we can
reconstruct the adjusted temperatures. The normalization we used
ensures that all of the reported values are relative to <span class="math notranslate nohighlight">\(20^\circ\)</span> C,
so there are no confidence intervals at this point.</p>
<p>For R, to get confidence intervals from <code class="docutils literal notranslate"><span class="pre">felm</span></code>, we use the
<code class="docutils literal notranslate"><span class="pre">predict.felm</span></code> function from the <code class="docutils literal notranslate"><span class="pre">felm-tools.R</span></code> library at
https://github.com/jrising/research-common/blob/master/R/felm-tools.R</p>
<div class="tabbed-set docutils">
<input checked="checked" id="2cb6bcaf-9e41-464b-beb8-051f10f022c2" name="6a3f9bfe-bd57-4286-8907-441f9e9358e9" type="radio">
</input><label class="tabbed-label" for="2cb6bcaf-9e41-464b-beb8-051f10f022c2">
R</label><div class="tabbed-content docutils">
<div class="highlight-R notranslate"><div class="highlight"><pre><span></span><span class="n">plotdf</span> <span class="o">&lt;-</span> <span class="nf">data.frame</span><span class="p">(</span><span class="n">tas</span><span class="o">=</span><span class="nf">seq</span><span class="p">(</span><span class="m">-20</span><span class="p">,</span> <span class="m">40</span><span class="p">))</span>
<span class="n">plotdf</span><span class="o">$</span><span class="n">tas_adj</span> <span class="o">&lt;-</span> <span class="n">plotdf</span><span class="o">$</span><span class="n">tas</span> <span class="o">-</span> <span class="m">20</span>
<span class="n">plotdf</span><span class="o">$</span><span class="n">tas_sq</span> <span class="o">&lt;-</span> <span class="n">plotdf</span><span class="o">$</span><span class="n">tas</span><span class="o">^</span><span class="m">2</span> <span class="o">-</span> <span class="m">20</span><span class="o">^</span><span class="m">2</span>

<span class="nf">source</span><span class="p">(</span><span class="s">&quot;felm-tools.R&quot;</span><span class="p">)</span>

<span class="n">preddf</span> <span class="o">&lt;-</span> <span class="nf">predict.felm</span><span class="p">(</span><span class="n">mod</span><span class="p">,</span> <span class="n">plotdf</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="s">&#39;confidence&#39;</span><span class="p">)</span>

<span class="n">plotdf2</span> <span class="o">&lt;-</span> <span class="nf">cbind</span><span class="p">(</span><span class="n">plotdf</span><span class="p">,</span> <span class="n">preddf</span><span class="p">)</span>

<span class="nf">library</span><span class="p">(</span><span class="n">ggplot2</span><span class="p">)</span>

<span class="nf">ggplot</span><span class="p">(</span><span class="n">plotdf2</span><span class="p">,</span> <span class="nf">aes</span><span class="p">(</span><span class="n">tas</span><span class="p">,</span> <span class="n">fit</span><span class="p">))</span> <span class="o">+</span>
    <span class="nf">geom_line</span><span class="p">()</span> <span class="o">+</span> <span class="nf">geom_ribbon</span><span class="p">(</span><span class="nf">aes</span><span class="p">(</span><span class="n">ymin</span><span class="o">=</span><span class="n">lwr</span><span class="p">,</span> <span class="n">ymax</span><span class="o">=</span><span class="n">upr</span><span class="p">),</span> <span class="n">alpha</span><span class="o">=</span><span class="n">.</span><span class="m">5</span><span class="p">)</span> <span class="o">+</span>
    <span class="nf">scale_x_continuous</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;Daily temperature (C)&quot;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="nf">c</span><span class="p">(</span><span class="m">0</span><span class="p">,</span> <span class="m">0</span><span class="p">))</span> <span class="o">+</span>
    <span class="nf">ylab</span><span class="p">(</span><span class="s">&quot;Deaths per 100,000 people&quot;</span><span class="p">)</span> <span class="o">+</span>
    <span class="nf">ggtitle</span><span class="p">(</span><span class="s">&quot;Excess death rate as a function of temperature&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="nf">theme_bw</span><span class="p">()</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/doseresp.png"><img alt="Dose-response function" src="../_images/doseresp.png" style="width: 750px;" /></a>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./content"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="producing-results.html" title="previous page">Producing results</a>
    <a class='right-next' id="next-link" href="suggestions.html" title="next page">Suggestions for work organization</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.3da636dd464baa7582d2.js"></script>


    
  </body>
</html>